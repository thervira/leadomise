
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>MainWindow &#8212; LEADOMISE FRAGMENTER TOOL 1.0.0 documentation</title>
    <link rel="stylesheet" href="../static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../static/documentation_options.js"></script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">LEADOMISE FRAGMENTER TOOL 1.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for MainWindow</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The PyQt5 GUI for LEADOMISE - Fragmenter Tool</span>
<span class="sd">=============================================</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">mysql</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">errno</span> <span class="k">import</span> <span class="n">errorcode</span>

<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="k">import</span> <span class="n">QFont</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="k">import</span> <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span>

<span class="kn">from</span> <span class="nn">rdkit</span> <span class="k">import</span> <span class="n">Chem</span><span class="p">,</span> <span class="n">DataStructs</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="k">import</span> <span class="n">AllChem</span><span class="p">,</span> <span class="n">Draw</span>

<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="k">import</span> <span class="n">pyqtSlot</span><span class="p">,</span> <span class="n">Qt</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="k">import</span> <span class="p">(</span><span class="n">QComboBox</span><span class="p">,</span> <span class="n">QAction</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QGridLayout</span><span class="p">,</span> <span class="n">QGroupBox</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span>
                             <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QRadioButton</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QSpinBox</span><span class="p">,</span>
                             <span class="n">QTabWidget</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QTableView</span><span class="p">,</span> <span class="n">qApp</span><span class="p">,</span> <span class="n">QMenu</span><span class="p">,</span> <span class="n">QCheckBox</span><span class="p">,</span>
                             <span class="n">QDoubleSpinBox</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">Fragmenter_brics</span> <span class="k">import</span> <span class="n">Fragmenter</span>
<span class="kn">from</span> <span class="nn">DataFrameModel</span> <span class="k">import</span> <span class="n">PandasModel</span><span class="p">,</span> <span class="n">SimpleModel</span>
<span class="kn">from</span> <span class="nn">CreatePlot</span> <span class="k">import</span> <span class="n">MplCanvas</span>
<span class="kn">from</span> <span class="nn">mysql_database</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">about_program</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;The tool for fast molecular fragmentation and data analysis.</span><span class="se">\n</span><span class="s2"> &quot;&quot;&quot;</span>

<span class="c1"># lists for selection boxes in the plot options widget</span>
<span class="n">plotTypeList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="s1">&#39;histogram&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;MolWeight&#39;</span><span class="p">,</span> <span class="s1">&#39;HBA&#39;</span><span class="p">,</span> <span class="s1">&#39;HBD&#39;</span><span class="p">,</span> <span class="s1">&#39;TPSA&#39;</span><span class="p">,</span> <span class="s1">&#39;HeavyAtoms&#39;</span><span class="p">,</span> <span class="s1">&#39;Charge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;RingCount&#39;</span><span class="p">,</span> <span class="s1">&#39;AromaticRings&#39;</span><span class="p">,</span> <span class="s1">&#39;AliphaticRings&#39;</span><span class="p">,</span> <span class="s1">&#39;RotatableBonds&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cLogP&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="MainWindow"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow">[docs]</a><span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; MainWindow comprises of four main group boxes:</span>
<span class="sd">        - Settings Group Box (for fragmentation set up),</span>
<span class="sd">        - Tab Widget (for dataframe with generated fragments for both input file fragments and database fragments),</span>
<span class="sd">        - Plot Options Group Box (with options to create plots),</span>
<span class="sd">        - Plot Box (with canvas for created plot).</span>

<span class="sd">        Additionally, there are:</span>
<span class="sd">        - Rules Group box (for database customization) and</span>
<span class="sd">        - Similarity Search Group Box (for searching similar fragments).</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;LEADOMISE - Fragmenter&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">1600</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">900</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input_df</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotDataFrame</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>

<div class="viewcode-block" id="MainWindow.initUI"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.initUI">[docs]</a>    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; InitUI with main layout containing the main group boxes.</span>
<span class="sd">        It sets the main window title and its size.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># set window title and its size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>

        <span class="c1"># create menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createMenu</span><span class="p">()</span>

        <span class="c1"># create group boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createSettingsGroupBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createPlotOptionsGroupBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createTabWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createPlotBox</span><span class="p">()</span>

        <span class="n">mainLayout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        <span class="n">mainLayout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settingsGroupBox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotOptionsGroupBox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotBox</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">mainLayout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>

        <span class="c1"># click button commands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openFileNameDialog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startFragmentation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFragmentsData</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.createMenu"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.createMenu">[docs]</a>    <span class="k">def</span> <span class="nf">createMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Menu of the main window. &quot;&quot;&quot;</span>

        <span class="n">mainMenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span> <span class="o">=</span> <span class="n">mainMenu</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;&amp;File&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span> <span class="o">=</span> <span class="n">mainMenu</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s1">&#39;&amp;Help&#39;</span><span class="p">)</span>

        <span class="c1"># save the data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveButton</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveButton</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveButton</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s1">&#39;Save the File&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputSave</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">(</span><span class="s1">&#39;Save Input File Fragments As&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveButton</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputSave</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">databaseSave</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">(</span><span class="s1">&#39;Save Database Fragments As&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveButton</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">databaseSave</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputSaveCSV</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;CSV&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSave</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputSaveCSV</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">databaseSaveCSV</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;CSV&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databaseSave</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">databaseSaveCSV</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputSaveSDF</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;SDF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSave</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputSaveSDF</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">databaseSaveSDF</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;SDF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databaseSave</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">databaseSaveSDF</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputSaveCSV</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveFileDialog_inputCSV</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databaseSaveCSV</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveFileDialog_databaseCSV</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputSaveSDF</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveFileDialog_inputSDF</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databaseSaveSDF</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveFileDialog_databaseSDF</span><span class="p">)</span>

        <span class="c1"># message about the program</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;About&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">about</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Tutorial&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tutorial</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s1">&#39;Documentation&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">documentation</span><span class="p">)</span>

        <span class="c1"># quit the App</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exitButton</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="s1">&#39;Quit&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exitButton</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="s1">&#39;Ctrl+Q&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exitButton</span><span class="o">.</span><span class="n">setStatusTip</span><span class="p">(</span><span class="s1">&#39;Quit application&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exitButton</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">qApp</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exitButton</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.about"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.about">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">about</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Information about the tool. &quot;&quot;&quot;</span>

        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">about</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;LEADOMISE - Fragmenter&quot;</span><span class="p">,</span> <span class="n">about_program</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.tutorial"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.tutorial">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">tutorial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Tutorial of the fragmenting tool.&quot;&quot;&quot;</span>

        <span class="n">dialog</span> <span class="o">=</span> <span class="n">TutorialDialog</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.documentation"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.documentation">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">documentation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Documentation of the fragmenting tool.&quot;&quot;&quot;</span>

        <span class="n">dialog</span> <span class="o">=</span> <span class="n">DocDialog</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.createSettingsGroupBox"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.createSettingsGroupBox">[docs]</a>    <span class="k">def</span> <span class="nf">createSettingsGroupBox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Group Box with settings for fragmentation process.</span>

<span class="sd">        Main Group box: file selection and MYSQL username and password information.</span>
<span class="sd">        Subgroup box: options for customized database.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">settingsGroupBox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Fragmentation Set Up&quot;</span><span class="p">)</span>

        <span class="c1"># labels with description</span>
        <span class="n">selectLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Select Input File&#39;</span><span class="p">)</span>
        <span class="n">usernameLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;MySQL Username:&#39;</span><span class="p">)</span>
        <span class="n">passwordLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;MySQL Password:&#39;</span><span class="p">)</span>

        <span class="c1"># text input and buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectedFileEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usernameEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passwordEdit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>

        <span class="c1"># add another group box withing this box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createRulesBox</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;START&#39;</span><span class="p">)</span>
        <span class="n">fontButton</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">()</span>
        <span class="n">fontButton</span><span class="o">.</span><span class="n">setBold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">fontButton</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">fontButton</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">passwordEdit</span><span class="o">.</span><span class="n">setEchoMode</span><span class="p">(</span><span class="n">QLineEdit</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>

        <span class="c1"># create the layout and add widgets to it</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">selectLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectedFileEdit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">usernameLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usernameEdit</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">passwordLabel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passwordEdit</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rulesGroupBox</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="c1"># adds the similarity search widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createSearchFragmentsBox</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searchFragmentBox</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">settingsGroupBox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.createPlotOptionsGroupBox"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.createPlotOptionsGroupBox">[docs]</a>    <span class="k">def</span> <span class="nf">createPlotOptionsGroupBox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Group Box with plot options.</span>

<span class="sd">        Select plot type, plot data (input file fragments or database fragments) - x, y axis.</span>

<span class="sd">        For histogram plots only: choose number of bins.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotOptionsGroupBox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Plot Options&quot;</span><span class="p">)</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># labels</span>
        <span class="n">plotTypeLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Plot Type:&#39;</span><span class="p">)</span>
        <span class="n">xAxisLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;X axis&#39;</span><span class="p">)</span>
        <span class="n">yAxisLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Y axis:&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotType</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xAxis</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yAxis</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Plot the data&#39;</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">plotTypeLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotType</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">xAxisLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xAxis</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">yAxisLabel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yAxis</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputFragmentsButton</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s1">&#39;Input </span><span class="se">\n</span><span class="s1"> Fragments&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputFragmentsButton</span><span class="o">.</span><span class="n">fragments</span> <span class="o">=</span> <span class="s1">&#39;input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputFragmentsButton</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputFragmentsButton</span><span class="p">))</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputFragmentsButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">databaseFragmentsButton</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s1">&#39;Database </span><span class="se">\n</span><span class="s1"> Fragments&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databaseFragmentsButton</span><span class="o">.</span><span class="n">fragments</span> <span class="o">=</span> <span class="s1">&#39;database&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databaseFragmentsButton</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonSelected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">databaseFragmentsButton</span><span class="p">))</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">databaseFragmentsButton</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">numBins</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numBins</span><span class="o">.</span><span class="n">setSuffix</span><span class="p">(</span><span class="s1">&#39; bins (histogram)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numBins</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numBins</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotButton</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># add lists of choices to combobox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotType</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotType</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">plotTypeList</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xAxis</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xAxis</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotOptionsGroupBox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.createSearchFragmentsBox"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.createSearchFragmentsBox">[docs]</a>    <span class="k">def</span> <span class="nf">createSearchFragmentsBox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Group Box for similarity search (part of Settings Group Box).  &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">searchFragmentBox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Similarity Search&quot;</span><span class="p">)</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="n">smilesLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;SMILES:&#39;</span><span class="p">)</span>
        <span class="n">tanimotoRangeLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Tanimoto Range:&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">smilesBox</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minTanimotoBox</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxTanimotoBox</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minTanimotoBox</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minTanimotoBox</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minTanimotoBox</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minTanimotoBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minTanimotoBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxTanimotoBox</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxTanimotoBox</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxTanimotoBox</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxTanimotoBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxTanimotoBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">searchButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Search&#39;</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">smilesLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smilesBox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">tanimotoRangeLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minTanimotoBox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxTanimotoBox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searchButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">searchButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searchSimilarFragments</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">searchFragmentBox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.createTabWidget"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.createTabWidget">[docs]</a>    <span class="k">def</span> <span class="nf">createTabWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Group Box with tab widget for input file fragments and database fragments.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Preferred</span><span class="p">,</span>
                                     <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Ignored</span><span class="p">)</span>

        <span class="c1"># creates tabs for input fragments and database fragments</span>
        <span class="n">tab_input</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">vLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">hLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">vLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hLayout</span><span class="p">)</span>

        <span class="c1"># empty table view of input fragments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_input</span> <span class="o">=</span> <span class="n">QTableView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_input</span><span class="o">.</span><span class="n">setSortingEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">tab_input_hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">tab_input_hbox</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">tab_input_hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_input</span><span class="p">)</span>
        <span class="n">tab_input</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">tab_input_hbox</span><span class="p">)</span>

        <span class="n">tab_database</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>

        <span class="c1"># empty table view of database fragments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_database</span> <span class="o">=</span> <span class="n">QTableView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_database</span><span class="o">.</span><span class="n">setSortingEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">tab_database_hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">tab_database_hbox</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">tab_database_hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_database</span><span class="p">)</span>
        <span class="n">tab_database</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">tab_database_hbox</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">tab_input</span><span class="p">,</span> <span class="s2">&quot;&amp;Input File Fragments&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">tab_database</span><span class="p">,</span> <span class="s2">&quot;&amp;Database Fragments&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.createPlotBox"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.createPlotBox">[docs]</a>    <span class="k">def</span> <span class="nf">createPlotBox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Group Box with empty plot canvas.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotBox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Plot&quot;</span><span class="p">)</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">MplCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

        <span class="c1"># add toolbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotBox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.createRulesBox"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.createRulesBox">[docs]</a>    <span class="k">def</span> <span class="nf">createRulesBox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rules for customized fragmentation:</span>

<span class="sd">        min fragment size,</span>
<span class="sd">        range of molecular weight,</span>
<span class="sd">        range of hydrogen bond acceptors,</span>
<span class="sd">        range of hydrogen bond donors,</span>
<span class="sd">        range of clogP,</span>
<span class="sd">        range of charge,</span>
<span class="sd">        range of heavy atoms,</span>
<span class="sd">        range of TPSA,</span>
<span class="sd">        range of rotatable bonds</span>

<span class="sd">        Check box for adding fragments to MySQL database (default: unchecked).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rulesGroupBox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Rules for fragmentation:&quot;</span><span class="p">)</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>

        <span class="c1"># labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minSizeFragmentLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Min. Fragment Size:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molWeightLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Mol Weight:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HBALabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;HBA:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HBDLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;HBD:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cLogPLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;cLogP:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chargeLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Charge:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heavyAtomsLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Heavy Atoms:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tpsaLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;TPSA:&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotatableBondsLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Rotatable Bonds:&#39;</span><span class="p">)</span>

        <span class="c1"># spinboxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minSizeFragmentBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minSizeFragmentBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minSizeFragmentBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># or maybe 3??</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minMolWeightBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minMolWeightBox</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minMolWeightBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minMolWeightBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxMolWeightBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxMolWeightBox</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxMolWeightBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxMolWeightBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minHBABox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHBABox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHBABox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHBABox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxHBABox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHBABox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHBABox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHBABox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minHBDBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHBDBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHBDBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHBDBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxHBDBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHBDBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHBDBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHBDBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minCLogPBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minCLogPBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minCLogPBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxCLogPBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxCLogPBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxCLogPBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxCLogPBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minChargeBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minChargeBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># not sure, can be changed later</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minChargeBox</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minChargeBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minChargeBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxChargeBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxChargeBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># not sure, can be changed later</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxChargeBox</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxChargeBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxChargeBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minHeavyAtomsBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHeavyAtomsBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHeavyAtomsBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minHeavyAtomsBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxHeavyAtomsBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHeavyAtomsBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># not sure, can be changed later</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHeavyAtomsBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxHeavyAtomsBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minTPSABox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minTPSABox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minTPSABox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minTPSABox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxTPSABox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxTPSABox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxTPSABox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxTPSABox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minRotatableBondsBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minRotatableBondsBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minRotatableBondsBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minRotatableBondsBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;min. &#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">maxRotatableBondsBox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxRotatableBondsBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxRotatableBondsBox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxRotatableBondsBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxRotatableBondsBox</span><span class="o">.</span><span class="n">setPrefix</span><span class="p">(</span><span class="s1">&#39;max. &#39;</span><span class="p">)</span>

        <span class="c1"># add check box to add the input file fragments to database (default - unchecked)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addToDatabase</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s1">&#39;add to database&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addToDatabase</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># add widgets to the layout</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minSizeFragmentLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minSizeFragmentBox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molWeightLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minMolWeightBox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxMolWeightBox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HBALabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minHBABox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxHBABox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HBDLabel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minHBDBox</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxHBDBox</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cLogPLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minCLogPBox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxCLogPBox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chargeLabel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minChargeBox</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxChargeBox</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heavyAtomsLabel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minHeavyAtomsBox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxHeavyAtomsBox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tpsaLabel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minTPSABox</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxTPSABox</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotatableBondsLabel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minRotatableBondsBox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRotatableBondsBox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addToDatabase</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minMolWeightBox</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">MinimumExpanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxMolWeightBox</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">MinimumExpanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rulesGroupBox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.plotFragmentsData"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.plotFragmentsData">[docs]</a>    <span class="k">def</span> <span class="nf">plotFragmentsData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a plot based on the selected options.</span>

<span class="sd">            :param setPlotType</span>
<span class="sd">                selected plot type</span>
<span class="sd">            :param setXAxis</span>
<span class="sd">                selected dataframe column for x axis</span>
<span class="sd">            :param setYAxis</span>
<span class="sd">                selected dataframe column for y axis</span>
<span class="sd">            :param numBins (optional)</span>
<span class="sd">                number of bins for histogram plot</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setPlotType</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotType</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setXAxis</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xAxis</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setYAxis</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yAxis</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>

        <span class="c1"># redraw the initial plot</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotDataFrame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setXAxis</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">xData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotDataFrame</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">setXAxis</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setYAxis</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotDataFrame</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">setYAxis</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

            <span class="c1"># Clear the canvas</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setPlotType</span> <span class="o">==</span> <span class="n">plotTypeList</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="c1"># scatter plot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xData</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yData</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">setPlotType</span> <span class="o">==</span> <span class="n">plotTypeList</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="c1"># line plot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xData</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yData</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">setPlotType</span> <span class="o">==</span> <span class="n">plotTypeList</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="c1"># histogram</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xData</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numBins</span><span class="o">.</span><span class="n">value</span><span class="p">()))</span>

            <span class="c1"># Update the plot on canvas</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.searchSimilarFragments"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.searchSimilarFragments">[docs]</a>    <span class="k">def</span> <span class="nf">searchSimilarFragments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Searches for similar fragments within both input file and database fragments</span>
<span class="sd">        based on the provided SMILES template.</span>

<span class="sd">        Dummy atoms from the provided SMILES template are not considered.</span>

<span class="sd">        :param smilesTemplate: str</span>
<span class="sd">            SMILES string for similarity search</span>
<span class="sd">        :param minTanimoto: float</span>
<span class="sd">            minimun Tanimoto similarity </span>
<span class="sd">        :param maxTanimoto: float</span>
<span class="sd">            maximum Tanimoto similarity</span>

<span class="sd">        Shows inputResults_model: dataframe</span>
<span class="sd">            dataframe with similarity results withing input file fragments</span>
<span class="sd">        Shows databseResults_model: dataframe</span>
<span class="sd">            dataframe with similarity results withing database fragments</span>

<span class="sd">        Result dataframes are shown in two additional tab widgets added to self.tabWidget</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">minTanimoto</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minTanimotoBox</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">maxTanimoto</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxTanimotoBox</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
        <span class="n">tanimoto_check</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">minTanimoto</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">maxTanimoto</span>

        <span class="c1"># Morgan fingerprints for smiles template</span>
        <span class="n">smilesTemplate</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smilesBox</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">molTemplate</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smilesTemplate</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">molTemplate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="p">(</span><span class="s1">&#39;Cannot read the input SMILES&#39;</span><span class="p">)</span>

        <span class="c1"># checks for dummies in entry molecule</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;[*]&#39;</span><span class="p">)</span>
        <span class="n">molNoDummies</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">DeleteSubstructs</span><span class="p">(</span><span class="n">molTemplate</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
        <span class="n">molNoDummies</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
        <span class="n">Chem</span><span class="o">.</span><span class="n">FastFindRings</span><span class="p">(</span><span class="n">molNoDummies</span><span class="p">)</span>
        <span class="n">fpMorganMol</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprintAsBitVect</span><span class="p">(</span><span class="n">molNoDummies</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nBits</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>

        <span class="c1"># dataframe with results within input fragments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputSearchResults</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Molecule&#39;</span><span class="p">,</span> <span class="s1">&#39;Smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;Tanimoto&#39;</span><span class="p">])</span>

        <span class="c1"># compare the template with fragments in both lists</span>
        <span class="k">for</span> <span class="n">input_smiles</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_NoDuplicates</span><span class="p">[</span><span class="s1">&#39;Smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>

            <span class="n">input_fr</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">input_smiles</span><span class="p">)</span>
            <span class="c1"># checks for dummies in entry molecule</span>
            <span class="n">frNoDummies</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">DeleteSubstructs</span><span class="p">(</span><span class="n">input_fr</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
            <span class="n">frNoDummies</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
            <span class="n">Chem</span><span class="o">.</span><span class="n">FastFindRings</span><span class="p">(</span><span class="n">frNoDummies</span><span class="p">)</span>
            <span class="n">fpMorganFR</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprintAsBitVect</span><span class="p">(</span><span class="n">frNoDummies</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nBits</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>

            <span class="n">tanimotoSimilarity</span> <span class="o">=</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">FingerprintSimilarity</span><span class="p">(</span><span class="n">fpMorganMol</span><span class="p">,</span> <span class="n">fpMorganFR</span><span class="p">,</span>
                                                                   <span class="n">metric</span><span class="o">=</span><span class="n">DataStructs</span><span class="o">.</span><span class="n">TanimotoSimilarity</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">tanimoto_check</span><span class="p">(</span><span class="n">tanimotoSimilarity</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inputSearchResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputSearchResults</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span><span class="s1">&#39;Molecule&#39;</span><span class="p">:</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolToQPixmap</span><span class="p">(</span><span class="n">input_fr</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)),</span>
                     <span class="s1">&#39;Smiles&#39;</span><span class="p">:</span> <span class="n">input_smiles</span><span class="p">,</span>
                     <span class="s1">&#39;Tanimoto&#39;</span><span class="p">:</span> <span class="n">tanimotoSimilarity</span>
                     <span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># dataframe with results within database fragments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databaseSearchResults</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Molecule&#39;</span><span class="p">,</span> <span class="s1">&#39;Smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;Tanimoto&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">database_smiles</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>

            <span class="n">database_fr</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">database_smiles</span><span class="p">)</span>
            <span class="c1"># checks for dummies in entry molecule</span>
            <span class="n">frNoDummies</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">DeleteSubstructs</span><span class="p">(</span><span class="n">database_fr</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
            <span class="n">frNoDummies</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
            <span class="n">Chem</span><span class="o">.</span><span class="n">FastFindRings</span><span class="p">(</span><span class="n">frNoDummies</span><span class="p">)</span>
            <span class="n">fpMorganFR</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprintAsBitVect</span><span class="p">(</span><span class="n">frNoDummies</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nBits</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>

            <span class="n">tanimotoSimilarity</span> <span class="o">=</span> <span class="n">DataStructs</span><span class="o">.</span><span class="n">FingerprintSimilarity</span><span class="p">(</span><span class="n">fpMorganMol</span><span class="p">,</span> <span class="n">fpMorganFR</span><span class="p">,</span>
                                                                   <span class="n">metric</span><span class="o">=</span><span class="n">DataStructs</span><span class="o">.</span><span class="n">TanimotoSimilarity</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">tanimoto_check</span><span class="p">(</span><span class="n">tanimotoSimilarity</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">databaseSearchResults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">databaseSearchResults</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span><span class="s1">&#39;Molecule&#39;</span><span class="p">:</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolToQPixmap</span><span class="p">(</span><span class="n">database_fr</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)),</span>
                     <span class="s1">&#39;Smiles&#39;</span><span class="p">:</span> <span class="n">database_smiles</span><span class="p">,</span>
                     <span class="s1">&#39;Tanimoto&#39;</span><span class="p">:</span> <span class="n">tanimotoSimilarity</span>
                     <span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">createTabsForResults</span><span class="p">()</span>

        <span class="c1"># set dataframe with input results to DataFrameModel</span>
        <span class="n">inputResults_model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputSearchResults</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_inputResults</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">inputResults_model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_inputResults</span><span class="o">.</span><span class="n">resizeRowsToContents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_inputResults</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>

        <span class="c1"># set dataframe with database results to DataFrameModel</span>
        <span class="n">databaseResults_model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">databaseSearchResults</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_databaseResults</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">databaseResults_model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_databaseResults</span><span class="o">.</span><span class="n">resizeRowsToContents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_databaseResults</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.createTabsForResults"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.createTabsForResults">[docs]</a>    <span class="k">def</span> <span class="nf">createTabsForResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates tabs with search results for input fragments and database fragments.</span>
<span class="sd">         Tabs are shown after search.</span>
<span class="sd">         &quot;&quot;&quot;</span>

        <span class="n">tab_inputResults</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">vLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">hLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">vLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hLayout</span><span class="p">)</span>

        <span class="c1"># empty table view of input fragments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_inputResults</span> <span class="o">=</span> <span class="n">QTableView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_inputResults</span><span class="o">.</span><span class="n">setSortingEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">tab_inputResults_hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">tab_inputResults_hbox</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">tab_inputResults_hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_inputResults</span><span class="p">)</span>
        <span class="n">tab_inputResults</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">tab_inputResults_hbox</span><span class="p">)</span>

        <span class="n">tab_databaseResults</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">vLayout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">hLayout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">vLayout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hLayout</span><span class="p">)</span>

        <span class="c1"># empty table view of input fragments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_databaseResults</span> <span class="o">=</span> <span class="n">QTableView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_databaseResults</span><span class="o">.</span><span class="n">setSortingEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">tab_databaseResults_hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">tab_databaseResults_hbox</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">tab_databaseResults_hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_databaseResults</span><span class="p">)</span>
        <span class="n">tab_databaseResults</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">tab_databaseResults_hbox</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">tab_inputResults</span><span class="p">,</span> <span class="s1">&#39;&amp;Input Fragments Results&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">tab_databaseResults</span><span class="p">,</span> <span class="s1">&#39;&amp;Database Fragments Results&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.openFileNameDialog"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.openFileNameDialog">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">openFileNameDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Opens the file dialog to select the input file for fragmentation.&quot;&quot;&quot;</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Select Input File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;All Files (*);;SD Files (*.sdf)&quot;</span><span class="p">,</span>
                                                       <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileName</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selectedFileEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileName</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.saveFileDialog_inputCSV"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.saveFileDialog_inputCSV">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">saveFileDialog_inputCSV</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Saves input fragments as CSV file.&quot;&quot;&quot;</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Save the File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                           <span class="s2">&quot;CSV Files (*.csv);;&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.saveFileDialog_databaseCSV"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.saveFileDialog_databaseCSV">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">saveFileDialog_databaseCSV</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Saves database fragments as CSV file.&quot;&quot;&quot;</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Save the File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                           <span class="s2">&quot;CSV Files (*.csv);;&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.saveFileDialog_databaseSDF"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.saveFileDialog_databaseSDF">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">saveFileDialog_databaseSDF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Saves database fragments as SDF. &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="k">import</span> <span class="n">PandasTools</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Save the File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                           <span class="s2">&quot;SDF Files (*.sdf);;&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">:</span>
            <span class="n">PandasTools</span><span class="o">.</span><span class="n">WriteSDF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">,</span> <span class="n">molColName</span><span class="o">=</span><span class="s1">&#39;Molecule3D&#39;</span><span class="p">,</span>
                                 <span class="n">properties</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span></div>

<div class="viewcode-block" id="MainWindow.saveFileDialog_inputSDF"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.saveFileDialog_inputSDF">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">saveFileDialog_inputSDF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Saves input fragments as SDF.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="k">import</span> <span class="n">PandasTools</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Save the File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                                           <span class="s2">&quot;SDF Files (*.sdf);;&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">:</span>
            <span class="n">PandasTools</span><span class="o">.</span><span class="n">WriteSDF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveFileName</span><span class="p">,</span> <span class="n">molColName</span><span class="o">=</span><span class="s1">&#39;Molecule3D&#39;</span><span class="p">,</span>
                                 <span class="n">properties</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span></div>

<div class="viewcode-block" id="MainWindow.startFragmentation"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.startFragmentation">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">startFragmentation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Starts the Fragmenter using the input file</span>
<span class="sd">        ( and username and password for MySQL only if &#39;add to database check box is checked in),</span>
<span class="sd">        as well as user-defined options for customized database.</span>

<span class="sd">         Shows database fragments table only if the box addToDatabase is checked in when running the fragmentation.</span>
<span class="sd">         Otherwise input fragments will not be uploaded into database and database dataframe will not be shown.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectedFileEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start_fragmenting</span> <span class="o">=</span> <span class="n">Fragmenter</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fileName</span><span class="p">,</span>
                                           <span class="n">username</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usernameEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                                           <span class="n">password</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passwordEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                                           <span class="n">minFragmentSize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minSizeFragmentBox</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                                           <span class="p">)</span>

            <span class="n">start_fragmenting</span><span class="o">.</span><span class="n">fragment</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">all_fragments</span> <span class="o">=</span> <span class="n">start_fragmenting</span><span class="o">.</span><span class="n">getDataFragments</span><span class="p">(</span><span class="n">minMolWeight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minMolWeightBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">maxMolWeight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxMolWeightBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">minHBA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minHBABox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">maxHBA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxHBABox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">minHBD</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minHBDBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">maxHBD</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxHBDBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">minLogP</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minCLogPBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">maxLogP</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxCLogPBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">minCharge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minChargeBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">maxCharge</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minChargeBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">minHeavyAtoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minHeavyAtomsBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">maxHeavyAtoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxHeavyAtomsBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">minTPSA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minTPSABox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">maxTPSA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxTPSABox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">minRotBonds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">minRotatableBondsBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                                                    <span class="n">maxRotBonds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRotatableBondsBox</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
                                                                    <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_fragments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># shows input fragment table</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inputFragments</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">addToDatabase</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usernameEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passwordEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">noMySQLInfo</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">start_fragmenting</span><span class="o">.</span><span class="n">upload_fragments</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">databaseFragments</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">noFileSelected</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.inputFragments"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.inputFragments">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">inputFragments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates pandas dataframe for fragments from the input file.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Molecule&#39;</span><span class="p">,</span> <span class="s1">&#39;Smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;MolWeight&#39;</span><span class="p">,</span> <span class="s1">&#39;HBA&#39;</span><span class="p">,</span> <span class="s1">&#39;HBD&#39;</span><span class="p">,</span> <span class="s1">&#39;TPSA&#39;</span><span class="p">,</span> <span class="s1">&#39;HeavyAtoms&#39;</span><span class="p">,</span>
                                              <span class="s1">&#39;Charge&#39;</span><span class="p">,</span> <span class="s1">&#39;RingCount&#39;</span><span class="p">,</span> <span class="s1">&#39;AromaticRings&#39;</span><span class="p">,</span> <span class="s1">&#39;AliphaticRings&#39;</span><span class="p">,</span>
                                              <span class="s1">&#39;RotatableBonds&#39;</span><span class="p">,</span> <span class="s1">&#39;cLogP&#39;</span><span class="p">,</span> <span class="s1">&#39;MorganFingerprints&#39;</span><span class="p">,</span> <span class="s1">&#39;Molecule3D&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_fragments</span><span class="p">:</span>
            <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMolBlock</span><span class="p">(</span><span class="n">fragment</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
            <span class="n">pixmap</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolToQPixmap</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">))</span>

            <span class="n">pattern</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;[*]&#39;</span><span class="p">)</span>
            <span class="n">molNoDummies</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">DeleteSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
            <span class="n">molNoDummies</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
            <span class="n">Chem</span><span class="o">.</span><span class="n">rdmolops</span><span class="o">.</span><span class="n">FastFindRings</span><span class="p">(</span><span class="n">molNoDummies</span><span class="p">)</span>
            <span class="n">morganFingerpirnts</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprintAsBitVect</span><span class="p">(</span><span class="n">molNoDummies</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">input_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_df</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;Molecule&#39;</span><span class="p">:</span> <span class="n">pixmap</span><span class="p">,</span>
                                                  <span class="s1">&#39;Smiles&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                  <span class="s1">&#39;HBA&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                  <span class="s1">&#39;HBD&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                                  <span class="s1">&#39;RingCount&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                                                  <span class="s1">&#39;TPSA&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">fragment</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span> <span class="mi">2</span><span class="p">),</span>
                                                  <span class="s1">&#39;HeavyAtoms&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
                                                  <span class="s1">&#39;MolWeight&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">fragment</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span> <span class="mi">2</span><span class="p">),</span>
                                                  <span class="s1">&#39;AromaticRings&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
                                                  <span class="s1">&#39;AliphaticRings&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>
                                                  <span class="s1">&#39;RotatableBonds&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                                                  <span class="s1">&#39;Charge&#39;</span><span class="p">:</span> <span class="n">fragment</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
                                                  <span class="s1">&#39;cLogP&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">fragment</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span>
                                                  <span class="s1">&#39;MorganFingerprints&#39;</span><span class="p">:</span> <span class="n">morganFingerpirnts</span><span class="p">,</span>
                                                  <span class="s1">&#39;Molecule3D&#39;</span><span class="p">:</span> <span class="n">mol</span><span class="p">,</span>
                                                  <span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># drop duplicates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Smiles&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_NoDuplicates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;Smiles&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># set dataframe with input fragments to DataFrameModel</span>
        <span class="n">input_model</span> <span class="o">=</span> <span class="n">PandasModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_NoDuplicates</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_input</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">input_model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_input</span><span class="o">.</span><span class="n">resizeRowsToContents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_input</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.databaseFragments"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.databaseFragments">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">databaseFragments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Takes the mysql username and password and connects to the mysql database. Then generates the pandas</span>
<span class="sd">        dataframe for the fragments stored in that database.</span>

<span class="sd">        It will not run if &#39;add to database&#39; checkbox is not selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">db_connection</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;fragments&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usernameEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                                          <span class="n">password</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passwordEdit</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
        <span class="k">except</span> <span class="n">mysql</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="o">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrongMySQLPassword</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cursor</span> <span class="o">=</span> <span class="n">db_connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM fragments&#39;</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Molecule&#39;</span><span class="p">,</span> <span class="s1">&#39;Smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;MolWeight&#39;</span><span class="p">,</span> <span class="s1">&#39;HBA&#39;</span><span class="p">,</span> <span class="s1">&#39;HBD&#39;</span><span class="p">,</span> <span class="s1">&#39;TPSA&#39;</span><span class="p">,</span> <span class="s1">&#39;HeavyAtoms&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;Charge&#39;</span><span class="p">,</span> <span class="s1">&#39;RingCount&#39;</span><span class="p">,</span> <span class="s1">&#39;AromaticRings&#39;</span><span class="p">,</span> <span class="s1">&#39;AliphaticRings&#39;</span><span class="p">,</span> <span class="s1">&#39;RotatableBonds&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;cLogP&#39;</span><span class="p">,</span> <span class="s1">&#39;MorganFingerprints&#39;</span><span class="p">,</span> <span class="s1">&#39;Molecule3D&#39;</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)):</span>
                <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMolBlock</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
                <span class="n">pixmap</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolToQPixmap</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">))</span>
                <span class="n">pixmap</span><span class="o">.</span><span class="n">scaled</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">KeepAspectRatio</span><span class="p">)</span>

                <span class="n">pattern</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;[*]&#39;</span><span class="p">)</span>
                <span class="n">molNoDummies</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">DeleteSubstructs</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>
                <span class="n">molNoDummies</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">()</span>
                <span class="n">Chem</span><span class="o">.</span><span class="n">rdmolops</span><span class="o">.</span><span class="n">FastFindRings</span><span class="p">(</span><span class="n">molNoDummies</span><span class="p">)</span>
                <span class="n">morganFingerpirnts</span> <span class="o">=</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">GetMorganFingerprintAsBitVect</span><span class="p">(</span><span class="n">molNoDummies</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;Molecule&#39;</span><span class="p">:</span> <span class="n">pixmap</span><span class="p">,</span>
                                          <span class="s1">&#39;Smiles&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
                                          <span class="s1">&#39;HBA&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                          <span class="s1">&#39;HBD&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
                                          <span class="s1">&#39;RingCount&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span>
                                          <span class="s1">&#39;TPSA&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span>
                                          <span class="s1">&#39;HeavyAtoms&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span>
                                          <span class="s1">&#39;MolWeight&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span>
                                          <span class="s1">&#39;AromaticRings&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">9</span><span class="p">],</span>
                                          <span class="s1">&#39;AliphaticRings&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">10</span><span class="p">],</span>
                                          <span class="s1">&#39;RotatableBonds&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">11</span><span class="p">],</span>
                                          <span class="s1">&#39;Charge&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">12</span><span class="p">],</span>
                                          <span class="s1">&#39;cLogP&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">13</span><span class="p">],</span>
                                          <span class="s1">&#39;MorganFingerprints&#39;</span><span class="p">:</span> <span class="n">morganFingerpirnts</span><span class="p">,</span>
                                          <span class="s1">&#39;Molecule3D&#39;</span><span class="p">:</span> <span class="n">mol</span><span class="p">,</span>
                                          <span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># set dataframe with database fragments to DataFrameModel</span>
            <span class="n">database_model</span> <span class="o">=</span> <span class="n">PandasModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_database</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">database_model</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_database</span><span class="o">.</span><span class="n">resizeRowsToContents</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pandasTV_database</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.buttonSelected"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.buttonSelected">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">buttonSelected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks selected RadioButton (input fragments/database fragments) and set up correct dataframe to</span>
<span class="sd">        plotDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">button</span><span class="o">.</span><span class="n">fragments</span> <span class="o">==</span> <span class="s2">&quot;input&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotDataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_df</span>

        <span class="k">if</span> <span class="n">button</span><span class="o">.</span><span class="n">fragments</span> <span class="o">==</span> <span class="s2">&quot;database&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotDataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span></div>

<div class="viewcode-block" id="MainWindow.noFileSelected"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.noFileSelected">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">noFileSelected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Throws an error message for lack of the selected input file for fragmentation.&quot;&quot;&quot;</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Please, select the Input File for fragmentation.&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.noMySQLInfo"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.noMySQLInfo">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">noMySQLInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Throws an error message for lack of information for MySQL database (username or password).&quot;&quot;&quot;</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Please, provide your MYSQL username and password </span><span class="se">\n</span><span class="s2"> &quot;</span>
                       <span class="s2">&quot;(if you want to add fragments to the database).&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.wrongMySQLPassword"><a class="viewcode-back" href="../modules/MainWindow.html#MainWindow.MainWindow.wrongMySQLPassword">[docs]</a>    <span class="nd">@pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">wrongMySQLPassword</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Throws dialog in GUI that Username and Password are incorrect.&quot;&quot;&quot;</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Username or password are incorrect. Please, try again.&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">LEADOMISE FRAGMENTER TOOL 1.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Joanna Zarnecka.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>